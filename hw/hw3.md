# HW3

PB20111689 蓝俊玮

## T1

> 在 PRAM-CREW 模型上，用 $n$ 个处理器在 $O(1)$ 时间求出数组 $A[1\cdots n]=\{0,\cdots,0,1,\cdots,1\}$ 最先为 $1$ 值的下标。写出并行伪代码

```python
for i=1 to n-1 par-do
	if A[i] == 0 and A[i+1] == 1 then
    	return i+1
return 1
```

这个问题很简单，由于在并发读互斥写模型上，因此我们不采用写值的方式，而是直接采用返回结果的方式。第 $i$ 个处理器会读取当前索引下的数组值和后续的值，若符合要求则会返回后继索引。若都没有找到，则说明 $1$ 就出现在第 $1$ 个位置。

## Ex 7.3

> 试分析算法 $7.3$ 的复杂度

根据书上算法 $7.3$ 的代码示例，第 (1) 步的复杂度为 $O(1)$。第 (2) 步的时间复杂度为 $O(n)$，虽然第 (2) 部分是并行执行的，但是执行 $rank(b_{i\log m}:A)$ 时可能需要遍历整个 $A$ 数组，因此这一步的时间是 $O(n)$ 的。但是，如果求 $rank(b_{i\log m}:A)$ 时可以并行地求解时，可以借鉴上面第一题的经验（这时候问题和上一题实质是一样的），这时候复杂度就是 $O(1)$ 的。第 (3) 步的时间需要进行数据写操作，则我们知道时间需要 $O(\log m)+O(j(i+1)-j(i))$，实际上这个复杂度和 $A$ 数组是相关的。其中的 $j(i+1)$ 和 $j(i)$ 就是 $B$ 数组中的数字在 $A$ 数组中的 $rank$。不妨就假设数组 $A$ 和数组 $B$ 中的元素均匀分布，那么 $A$ 中划分出来的数据大概就是 $\frac{n}{m/\log m}=\frac{n}{m}\log m$。则此时第 (3) 步的时间为 $O(\log m+\frac{n}{m}\log m=\frac{n+m}{m}\log m)$。根据老师课上所说的，若 $m\sim O(1)$，则时间为 $O(n)$，若 $m\sim n$，则时间为 $O(\log n)$。

总上所述，若 $m\sim O(1)$，则复杂度为 $O(1)+O(n)+O(n)=O(2n)$；若 $m\sim n$，则复杂度为 $O(1)+O(n)+O(\log n)=O(n+\log n)$。（实际上复杂度就是 $O(n+\frac{n+m}{m}\log m)$）

> 令 $A=[0,1,2,7,9,11,16,17,18,19,23,24,25,27,28,30,33,34]$，$B=[3,4,5,6,8,10,12,13,14,15,20,21,22,26,29,31]$。试按算法 $7.3$ 对其进行对数划分，并最终将它们归并之。

数组 $A$ 的大小为 $n=18$，数组 $B$ 的大小为 $m=16$，则 $\frac{m}{\log m}=4$，则从数组 $B$ 中选出第 $4,8,12$ 个数字为 $6,13,21$，它们的 $rank=3,6,10$，那么可以划分出：

- $A_0=[0,1,2],B_0=[3,4,5,6]$
- $A_1=[7,9,11],B_1=[8,10,12,13]$
- $A_2=[16,17,18,19],B_2=[14,15,20,21]$
- $A_3=[23,24,25,27,28,30,33,34],B_3=[22,26,29,31]$

分段归并得到：

- $[0,1,2,3,4,5,6]$
- $[7,8,9,10,11,12,13]$
- $[14,15,16,17,18,19,20,21]$
- $[22,23,24,25,26,27,28,29,30,31,33,34]$

最终归并得到：

$[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,33,34]$

## Ex 7.6

> 试分析算法 $7.9$ 的总运算量 $W(n)$
>
> **(注：这题被扣了 1 分，根据助教说法，运算量按复制操作和乘法操作分开计算，会有一个 $-\log(n)$ 项)**

第 (1) 步运算量显然为 $O(n)$。

第 (2) 步进行正向遍历，则运算量为：

$$
O(\sum_{h=1}^{\log n}\frac{n}{2^h})=O\bigg(n(\frac{\frac{1}{2}(1-(\frac{1}{2})^{\log n})}{1-\frac{1}{2}})\bigg)=O\bigg(n(1-(\frac{1}{2})^{\log n})\bigg)=O\bigg(n(1-\frac{1}{n})\bigg)=O(n)
$$

第 (3) 步进行反向遍历，则运算量为：

$$
O(\sum_{h=0}^{\log n}\frac{n}{2^h})=O\bigg(n(\frac{(1-(\frac{1}{2})^{\log n})}{1-\frac{1}{2}})\bigg)=O\bigg(2n(1-(\frac{1}{2})^{\log n})\bigg)=O\bigg(2n(1-\frac{1}{n})\bigg)=O(2n)
$$

因为判断节点为哪种情况下，都执行一次运算（这些情况是互斥的）

所以总的运算量 $W(n)=O(n)+O(n)+O(2n)=O(4n)$。

> 假定序列为 $(1,2,3,4,5,6,7,8)$，试用算法 $7.9$ 求其前缀和

初始化 $B(0,j)$：

|    j     |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |
| :------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $B(0,j)$ |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |
| $B(1,j)$ |      |      |      |      |      |      |      |      |
| $B(2,j)$ |      |      |      |      |      |      |      |      |
| $B(3,j)$ |      |      |      |      |      |      |      |      |

然后正向遍历计算出 $B(h,j)=B(h-1,2j-1)*B(h-1,2j)$

|    j     |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |
| :------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $B(0,j)$ |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |
| $B(1,j)$ |  3   |  7   |  11  |  15  |      |      |      |      |
| $B(2,j)$ |  10  |  26  |      |      |      |      |      |      |
| $B(3,j)$ |  36  |      |      |      |      |      |      |      |

最后反向遍历，求出 $C$ 为：

|    j     |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |
| :------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $C(0,j)$ |  1   |  3   |  6   |  10  |  15  |  21  |  28  |  36  |
| $C(1,j)$ |  3   |  10  |  21  |  36  |      |      |      |      |
| $C(2,j)$ |  10  |  36  |      |      |      |      |      |      |
| $C(3,j)$ |  36  |      |      |      |      |      |      |      |

最后得到 $C(0,j)$ 为前缀和序列。